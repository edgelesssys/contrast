"use strict";(self.webpackChunkcontrast_docs=self.webpackChunkcontrast_docs||[]).push([[6280],{28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>s});var o=n(96540);const i={},r=o.createContext(i);function a(e){const t=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),o.createElement(r.Provider,{value:t},e.children)}},85452:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"howto/workload-deployment/deployment-verification","title":"Deployment verification","description":"This step verifies that the application has been deployed correctly.","source":"@site/versioned_docs/version-1.12/howto/workload-deployment/deployment-verification.md","sourceDirName":"howto/workload-deployment","slug":"/howto/workload-deployment/deployment-verification","permalink":"/contrast/pr-preview/pr-1761/1.12/howto/workload-deployment/deployment-verification","draft":false,"unlisted":false,"editUrl":"https://github.com/edgelesssys/contrast/edit/main/docs/versioned_docs/version-1.12/howto/workload-deployment/deployment-verification.md","tags":[],"version":"1.12","frontMatter":{},"sidebar":"docs","previous":{"title":"Set manifest","permalink":"/contrast/pr-preview/pr-1761/1.12/howto/workload-deployment/set-manifest"},"next":{"title":"Communicate with workloads","permalink":"/contrast/pr-preview/pr-1761/1.12/howto/workload-deployment/workload-communication"}}');var i=n(74848),r=n(28453);const a={},s="Deployment verification",c={},l=[{value:"Applicability",id:"applicability",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"How-to",id:"how-to",level:2},{value:"Connect to the Coordinator",id:"connect-to-the-coordinator",level:3},{value:"Verify deployment",id:"verify-deployment",level:3}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"deployment-verification",children:"Deployment verification"})}),"\n",(0,i.jsx)(t.p,{children:"This step verifies that the application has been deployed correctly."}),"\n",(0,i.jsx)(t.h2,{id:"applicability",children:"Applicability"}),"\n",(0,i.jsx)(t.p,{children:"An application user can use this step to verify the deployment before interacting with the application."}),"\n",(0,i.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"A running Contrast deployment."}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"/contrast/pr-preview/pr-1761/1.12/howto/install-cli",children:"Install CLI"})}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"how-to",children:"How-to"}),"\n",(0,i.jsx)(t.p,{children:"This page explains how a user can connect to the Coordinator and verify the application's integrity."}),"\n",(0,i.jsx)(t.h3,{id:"connect-to-the-coordinator",children:"Connect to the Coordinator"}),"\n",(0,i.jsx)(t.p,{children:"For the next steps, we will need to connect to the Coordinator. The released Coordinator resource\nincludes a LoadBalancer definition we can use."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sh",children:"coordinator=$(kubectl get svc coordinator -o=jsonpath='{.status.loadBalancer.ingress[0].ip}')\n"})}),"\n",(0,i.jsxs)(t.admonition,{title:"Port-forwarding of Confidential Containers",type:"info",children:[(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.code,{children:"kubectl port-forward"})," uses a Container Runtime Interface (CRI) method that isn't supported by the Kata shim.\nIf you can't use a public load balancer, you can deploy a port-forwarding pod to relay traffic to a Contrast pod:"]}),(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",children:"apiVersion: v1\nkind: Pod\nmetadata:\n  name: port-forwarder-coordinator\nspec:\n  containers:\n    - name: port-forwarder\n      image: alpine/socat\n      args:\n        - -d\n        - TCP-LISTEN:1313,fork\n        - TCP:coordinator:1313\n      resources:\n        requests:\n          memory: 50Mi\n        limits:\n          memory: 50Mi\n"})}),(0,i.jsxs)(t.p,{children:["Upstream tracking issue: ",(0,i.jsx)(t.a,{href:"https://github.com/kata-containers/kata-containers/issues/1693",children:"https://github.com/kata-containers/kata-containers/issues/1693"}),"."]})]}),"\n",(0,i.jsx)(t.h3,{id:"verify-deployment",children:"Verify deployment"}),"\n",(0,i.jsxs)(t.p,{children:["An end user (data owner) can verify the Contrast deployment using the ",(0,i.jsx)(t.code,{children:"verify"})," command."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sh",children:'contrast verify -c "${coordinator}:1313"\n'})}),"\n",(0,i.jsxs)(t.p,{children:["The CLI will attest the Coordinator using the reference values from the given manifest file. It will then write the\nservice mesh root certificate and the history of manifests into the ",(0,i.jsx)(t.code,{children:"verify/"})," directory. In addition, the policies\nreferenced in the active manifest are also written to the directory. The verification will fail if the active\nmanifest at the Coordinator doesn't match the manifest passed to the CLI."]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);