"use strict";(globalThis.webpackChunkcontrast_docs=globalThis.webpackChunkcontrast_docs||[]).push([[73083],{28453(e,t,n){n.d(t,{R:()=>i,x:()=>l});var o=n(96540);const r={},s=o.createContext(r);function i(e){const t=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(s.Provider,{value:t},e.children)}},57503(e,t,n){n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"howto/workload-deployment/runtime-deployment","title":"Deploy the Contrast runtime","description":"This step configures the host environment on your Kubernetes worker nodes.","source":"@site/docs/howto/workload-deployment/runtime-deployment.md","sourceDirName":"howto/workload-deployment","slug":"/howto/workload-deployment/runtime-deployment","permalink":"/contrast/pr-preview/pr-2097/next/howto/workload-deployment/runtime-deployment","draft":false,"unlisted":false,"editUrl":"https://github.com/edgelesssys/contrast/edit/main/docs/docs/howto/workload-deployment/runtime-deployment.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Install CLI","permalink":"/contrast/pr-preview/pr-2097/next/howto/install-cli"},"next":{"title":"Add Coordinator to resources","permalink":"/contrast/pr-preview/pr-2097/next/howto/workload-deployment/add-coordinator"}}');var r=n(74848),s=n(28453);const i={},l="Deploy the Contrast runtime",a={},d=[{value:"Applicability",id:"applicability",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"How-to",id:"how-to",level:2},{value:"Multi-runtime configurations",id:"multi-runtime-configurations",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components},{TabItem:n,Tabs:o}=t;return n||p("TabItem",!0),o||p("Tabs",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"deploy-the-contrast-runtime",children:"Deploy the Contrast runtime"})}),"\n",(0,r.jsx)(t.p,{children:"This step configures the host environment on your Kubernetes worker nodes."}),"\n",(0,r.jsx)(t.h2,{id:"applicability",children:"Applicability"}),"\n",(0,r.jsx)(t.p,{children:"Required for all Contrast deployments."}),"\n",(0,r.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"/contrast/pr-preview/pr-2097/next/howto/cluster-setup/bare-metal",children:"Set up cluster"})}),"\n",(0,r.jsx)(t.li,{children:(0,r.jsx)(t.a,{href:"/contrast/pr-preview/pr-2097/next/howto/install-cli",children:"Install CLI"})}),"\n"]}),"\n",(0,r.jsx)(t.h2,{id:"how-to",children:"How-to"}),"\n",(0,r.jsxs)(t.p,{children:["Contrast depends on a ",(0,r.jsxs)(t.a,{href:"/contrast/pr-preview/pr-2097/next/architecture/components/runtime",children:["custom Kubernetes ",(0,r.jsx)(t.code,{children:"RuntimeClass"})," (",(0,r.jsx)(t.code,{children:"contrast-cc"}),")"]}),", which needs to be installed in the cluster prior to the Coordinator or any confidential workloads.\nThis consists of a ",(0,r.jsx)(t.code,{children:"RuntimeClass"})," resource and the node installer ",(0,r.jsx)(t.code,{children:"DaemonSet"})," that performs installation on worker nodes.\nThe node installer is deployed in the ",(0,r.jsx)(t.code,{children:"contrast-system"})," namespace by default but this can be changed by modifying the YAML files if you wish.\nThis step is only required once for each version of the runtime.\nIt can be shared between Contrast deployments.\nAlso, different Contrast runtime versions can be installed in the same cluster."]}),"\n",(0,r.jsxs)(o,{queryString:"platform",children:[(0,r.jsx)(n,{value:"metal-qemu-snp",label:"Bare metal (SEV-SNP)",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:"kubectl apply -f https://github.com/edgelesssys/contrast/releases/latest/download/runtime-metal-qemu-snp.yml\n"})})}),(0,r.jsx)(n,{value:"metal-qemu-snp-gpu",label:"Bare metal (SEV-SNP, with GPU support)",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:"kubectl apply -f https://github.com/edgelesssys/contrast/releases/latest/download/runtime-metal-qemu-snp-gpu.yml\n"})})}),(0,r.jsx)(n,{value:"metal-qemu-tdx",label:"Bare metal (TDX)",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:"kubectl apply -f https://github.com/edgelesssys/contrast/releases/latest/download/runtime-metal-qemu-tdx.yml\n"})})}),(0,r.jsx)(n,{value:"metal-qemu-tdx-gpu",label:"Bare metal (TDX, with GPU support)",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-sh",children:"kubectl apply -f https://github.com/edgelesssys/contrast/releases/latest/download/runtime-metal-qemu-tdx-gpu.yml\n"})})})]}),"\n",(0,r.jsxs)(t.admonition,{title:"Modifications to containerd configuration",type:"warning",children:[(0,r.jsx)(t.p,{children:"The Contrast node installer will modify the containerd configuration on the worker nodes to add the runtime class.\nA backup will be created for the original configuration."}),(0,r.jsx)(t.p,{children:"Some Kubernetes platforms, for example K3s, use a template for the containerd configuration.\nNotice that Contrast can't modify these templates, but will write the templated version instead.\nAny modifications made to the template afterward won't take effect."})]}),"\n",(0,r.jsx)(t.h2,{id:"multi-runtime-configurations",children:"Multi-runtime configurations"}),"\n",(0,r.jsx)(t.p,{children:"Depending on the configuration of your cluster and the workloads to deploy, it can be desirable to use different runtime classes for pods some pods.\nFor example, in a cluster consisting of both SEV-SNP and TDX machines, you might want to distribute the workload over all nodes."}),"\n",(0,r.jsxs)(t.p,{children:["Contrast supports these multi-runtime class configurations. For details, please see ",(0,r.jsx)(t.a,{href:"/contrast/pr-preview/pr-2097/next/howto/multi-runtime-class",children:"the multi-runtime class How To"}),"."]})]})}function u(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}function p(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}}}]);