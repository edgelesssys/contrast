"use strict";(self.webpackChunkcontrast_docs=self.webpackChunkcontrast_docs||[]).push([[9273],{28453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>o});var i=n(96540);const s={},r=i.createContext(s);function a(e){const t=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(r.Provider,{value:t},e.children)}},68204:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>l,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"architecture/attestation/overview","title":"Attestation in Contrast","description":"Contrast uses remote attestation to ensure that each workload pod runs in a verifiable and trusted environment. Every pod is executed inside a Confidential Virtual Machine (CVM), and its integrity and configuration are verified at launch using hardware-based attestation.","source":"@site/docs/architecture/attestation/overview.md","sourceDirName":"architecture/attestation","slug":"/architecture/attestation/overview","permalink":"/contrast/pr-preview/pr-1577/next/architecture/attestation/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/edgelesssys/contrast/edit/main/docs/docs/architecture/attestation/overview.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Service mesh","permalink":"/contrast/pr-preview/pr-1577/next/architecture/components/service-mesh"},"next":{"title":"AMD SEV-SNP","permalink":"/contrast/pr-preview/pr-1577/next/architecture/attestation/amd-details"}}');var s=n(74848),r=n(28453);const a={},o="Attestation in Contrast",d={},c=[{value:"Attestation roles in Contrast",id:"attestation-roles-in-contrast",level:2},{value:"Attester: Confidential pods",id:"attester-confidential-pods",level:3},{value:"Verifier: Contrast Coordinator &amp; CLI",id:"verifier-contrast-coordinator--cli",level:3},{value:"Relying party: Operator and data owner",id:"relying-party-operator-and-data-owner",level:3},{value:"Evidence generation and verification",id:"evidence-generation-and-verification",level:2},{value:"What&#39;s included in the attestation report?",id:"whats-included-in-the-attestation-report",level:3},{value:"How verification works",id:"how-verification-works",level:3},{value:"Summary",id:"summary",level:2},{value:"FAQ",id:"faq",level:2},{value:"What&#39;s the purpose of remote attestation in Contrast?",id:"whats-the-purpose-of-remote-attestation-in-contrast",level:3},{value:"How does Contrast ensure the security of the attestation process?",id:"how-does-contrast-ensure-the-security-of-the-attestation-process",level:3},{value:"What security benefits does attestation provide?",id:"what-security-benefits-does-attestation-provide",level:3},{value:"How can you verify the authenticity of attestation results?",id:"how-can-you-verify-the-authenticity-of-attestation-results",level:3},{value:"How are attestation results used by relying parties?",id:"how-are-attestation-results-used-by-relying-parties",level:3}];function h(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"attestation-in-contrast",children:"Attestation in Contrast"})}),"\n",(0,s.jsx)(t.p,{children:"Contrast uses remote attestation to ensure that each workload pod runs in a verifiable and trusted environment. Every pod is executed inside a Confidential Virtual Machine (CVM), and its integrity and configuration are verified at launch using hardware-based attestation."}),"\n",(0,s.jsxs)(t.p,{children:["The attestation process builds on Remote Attestation Procedures (RATS) as described in ",(0,s.jsx)(t.a,{href:"https://www.rfc-editor.org/rfc/rfc9334.html",children:"RFC 9334"}),", but is tailored specifically for Kubernetes and the Contrast architecture."]}),"\n",(0,s.jsx)(t.h2,{id:"attestation-roles-in-contrast",children:"Attestation roles in Contrast"}),"\n",(0,s.jsx)(t.p,{children:"Contrast separates responsibilities across three attestation roles:"}),"\n",(0,s.jsx)(t.h3,{id:"attester-confidential-pods",children:"Attester: Confidential pods"}),"\n",(0,s.jsx)(t.p,{children:"Each pod is launched inside a CVM using a secure runtime based on Kata Containers. During launch:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"The CPU (AMD SEV-SNP or Intel TDX) measures the initial guest memory\u2014including the kernel, initramfs and kernel command line."}),"\n",(0,s.jsx)(t.li,{children:"The measurement is embedded in a hardware-signed attestation report."}),"\n",(0,s.jsxs)(t.li,{children:["A hash of the pod\u2019s runtime policy is embedded in a dedicated field of the report(",(0,s.jsx)(t.code,{children:"HOSTDATA"})," on SEV-SNP or ",(0,s.jsx)(t.code,{children:"MRCONFIGID"})," on TDX)."]}),"\n",(0,s.jsx)(t.li,{children:"The report is signed by the CPU firmware and verifiable via vendor-provided public keys."}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["The runtime policy is enforced inside the CVM by the ",(0,s.jsx)(t.code,{children:"kata-agent"}),". On startup, the agent:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Reads the Base64-encoded policy passed in as a pod annotation."}),"\n",(0,s.jsx)(t.li,{children:"Computes a SHA-256 hash of the policy document."}),"\n",(0,s.jsx)(t.li,{children:"Compares this hash against the value embedded in the attestation report."}),"\n",(0,s.jsx)(t.li,{children:"Aborts execution if the hash doesn't match."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"The runtime policy specifies:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Which container images (by cryptographic hash) may be executed"}),"\n",(0,s.jsx)(t.li,{children:"Which environment variables are permitted"}),"\n",(0,s.jsx)(t.li,{children:"Which mount points may be used"}),"\n",(0,s.jsx)(t.li,{children:"Which host-to-guest calls are allowed"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"This guarantees that the CVM launches in a well-defined state and enforces only the explicitly declared configuration."}),"\n",(0,s.jsx)(t.h3,{id:"verifier-contrast-coordinator--cli",children:"Verifier: Contrast Coordinator & CLI"}),"\n",(0,s.jsx)(t.p,{children:"The Coordinator runs inside a CVM and verifies attestation reports from other pods. It:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Checks launch measurements and policy hashes against a trusted ",(0,s.jsx)(t.strong,{children:"manifest"})]}),"\n",(0,s.jsx)(t.li,{children:"Issues service mesh certificates to verified pods"}),"\n",(0,s.jsx)(t.li,{children:"Functions as the verifier for the full deployment"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.strong,{children:"manifest"})," is a JSON configuration that defines the trusted state of the deployment. It includes:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"ReferenceValues"}),": Expected CVM launch measurements"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Policies"}),": Hashes of accepted runtime policies"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"WorkloadOwnerKeyDigests"}),": Public key digests used to authorize future manifest updates"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"SeedshareOwnerPubKeys"}),": Used for securely recovering workload secrets and restoring trust"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Only pods whose attestation evidence matches the manifest are accepted into the trusted service mesh."}),"\n",(0,s.jsx)(t.p,{children:"The Contrast Coordinator itself also runs as a confidential pod and is attested using the Contrast CLI.\nThe CLI includes embedded reference values for the Coordinator, allowing it to verify the Coordinator's identity and integrity during attestation.\nBecause these reference values are part of the CLI build, the CLI effectively serves as the root of trust for the deployment.\nVerifying the CLI\u2019s integrity and authenticity is therefore essential."}),"\n",(0,s.jsx)(t.h3,{id:"relying-party-operator-and-data-owner",children:"Relying party: Operator and data owner"}),"\n",(0,s.jsx)(t.p,{children:"The Contrast CLI is used by operators or data owners to verify the deployment and establish trust. It:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Verifies the attestation of the Coordinator using embedded reference values"}),"\n",(0,s.jsx)(t.li,{children:"Uploads the Manifest to define the trusted deployment state"}),"\n",(0,s.jsx)(t.li,{children:"Retrieves the Root CA and Mesh CA certificates for the service mesh"}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"evidence-generation-and-verification",children:"Evidence generation and verification"}),"\n",(0,s.jsx)(t.h3,{id:"whats-included-in-the-attestation-report",children:"What's included in the attestation report?"}),"\n",(0,s.jsx)(t.p,{children:"Each attestation report contains:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Launch Measurement"}),": A cryptographic digest of the guest memory at CVM startup"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Runtime Policy Hash"}),": The policy is embedded by the host and verified by the ",(0,s.jsx)(t.code,{children:"kata-agent"})]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Platform Info"}),": CPU type, TCB version, microcode versions"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"REPORTDATA"}),": A hash of the CVM\u2019s public key and a nonce, ensuring freshness and binding the attestation to a specific TLS session"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"how-verification-works",children:"How verification works"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"The Coordinator receives the attestation report from each pod."}),"\n",(0,s.jsx)(t.li,{children:"It compares the launch measurement and policy hash to the manifest."}),"\n",(0,s.jsx)(t.li,{children:"If the evidence matches, the pod is approved and issued a Mesh CA certificate."}),"\n",(0,s.jsx)(t.li,{children:"If the evidence doesn't match, the pod is rejected and can't join the mesh."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"The CLI verifies the Coordinator in the same way, using reference values embedded during the Contrast build process."}),"\n",(0,s.jsx)(t.h2,{id:"summary",children:"Summary"}),"\n",(0,s.jsx)(t.p,{children:"Contrast enforces trust across a Kubernetes deployment using hardware-based attestation. Each pod\u2019s launch state and configuration are verified before it can access secrets or participate in the mesh. The Coordinator acts as a centralized verifier, using a declarative manifest to define the trusted state. The CLI provides an interface for verification and certificate retrieval, completing a robust and transparent attestation workflow."}),"\n",(0,s.jsx)(t.h2,{id:"faq",children:"FAQ"}),"\n",(0,s.jsx)(t.h3,{id:"whats-the-purpose-of-remote-attestation-in-contrast",children:"What's the purpose of remote attestation in Contrast?"}),"\n",(0,s.jsx)(t.p,{children:"Remote attestation in Contrast ensures that software runs within a secure, isolated confidential computing environment.\nThis process certifies that the memory is encrypted and confirms the integrity and authenticity of the software running within the deployment.\nBy validating the runtime environment and the policies enforced on it, Contrast ensures that the system operates in a trustworthy state and hasn't been tampered with."}),"\n",(0,s.jsx)(t.h3,{id:"how-does-contrast-ensure-the-security-of-the-attestation-process",children:"How does Contrast ensure the security of the attestation process?"}),"\n",(0,s.jsx)(t.p,{children:"Contrast leverages hardware-rooted security features such as AMD SEV-SNP or Intel TDX to generate cryptographic evidence of a pod\u2019s current state and configuration.\nThis evidence is checked against pre-defined appraisal policies to guarantee that only verified and authorized pods are part of a Contrast deployment."}),"\n",(0,s.jsx)(t.h3,{id:"what-security-benefits-does-attestation-provide",children:"What security benefits does attestation provide?"}),"\n",(0,s.jsxs)(t.p,{children:["Attestation confirms the integrity of the runtime environment and the identity of the workloads.\nIt plays a critical role in preventing unauthorized changes and detecting potential modifications at runtime.\nThe attestation provides integrity and authenticity guarantees, enabling relying parties\u2014such as workload operators or data owners\u2014to confirm the effective protection against potential threats, including malicious cloud insiders, co-tenants, or compromised workload operators.\nMore details on the specific security benefits can be found ",(0,s.jsx)(t.a,{href:"/contrast/pr-preview/pr-1577/next/security",children:"here"}),"."]}),"\n",(0,s.jsx)(t.h3,{id:"how-can-you-verify-the-authenticity-of-attestation-results",children:"How can you verify the authenticity of attestation results?"}),"\n",(0,s.jsx)(t.p,{children:"Attestation results in Contrast are tied to cryptographic proofs generated and signed by the hardware itself.\nThese proofs are then verified using public keys from trusted hardware vendors, ensuring that the results aren't only accurate but also resistant to tampering.\nFor further authenticity verification, all of Contrast's code is reproducibly built, and the attestation evidence can be verified locally from the source code."}),"\n",(0,s.jsx)(t.h3,{id:"how-are-attestation-results-used-by-relying-parties",children:"How are attestation results used by relying parties?"}),"\n",(0,s.jsxs)(t.p,{children:["Relying parties use attestation results to make informed security decisions, such as allowing access to sensitive data or resources only if the attestation verifies the system's integrity.\nThereafter, the use of Contrast's ",(0,s.jsx)(t.a,{href:"/contrast/pr-preview/pr-1577/next/architecture/components/service-mesh",children:"CA certificates in TLS connections"})," provides a practical approach to communicate securely with the application."]})]})}function l(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);