<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-1.4 docs-doc-page docs-doc-id-examples/mysql" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Encrypted volume mount | Contrast</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.edgeless.systems/contrast/1.4/examples/mysql"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="1.4"><meta data-rh="true" name="docusaurus_tag" content="docs-default-1.4"><meta data-rh="true" name="docsearch:version" content="1.4"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-1.4"><meta data-rh="true" property="og:title" content="Encrypted volume mount | Contrast"><meta data-rh="true" name="description" content="This tutorial guides you through deploying a simple application with an"><meta data-rh="true" property="og:description" content="This tutorial guides you through deploying a simple application with an"><link data-rh="true" rel="icon" href="/contrast/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.edgeless.systems/contrast/1.4/examples/mysql"><link data-rh="true" rel="alternate" href="https://docs.edgeless.systems/contrast/1.4/examples/mysql" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.edgeless.systems/contrast/1.4/examples/mysql" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Encrypted volume mount","item":"https://docs.edgeless.systems/contrast/1.4/examples/mysql"}]}</script><script src="/contrast/gtagman.js" async data-cookieconsent="ignore"></script><link rel="stylesheet" href="/contrast/assets/css/styles.979edda2.css">
<script src="/contrast/assets/js/runtime~main.ecf623de.js" defer="defer"></script>
<script src="/contrast/assets/js/main.cac300c7.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/contrast/img/logos/contrast_icon.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/contrast/"><div class="navbar__logo"><img src="/contrast/img/logos/contrast_icon.svg" alt="Contrast Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/contrast/img/logos/contrast_icon.svg" alt="Contrast Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link active" aria-haspopup="true" aria-expanded="false" role="button" href="/contrast/1.4/examples/mysql">1.4</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/contrast/next">Next</a></li><li><a class="dropdown__link" href="/contrast/">1.15</a></li><li><a class="dropdown__link" href="/contrast/1.14">1.14</a></li><li><a class="dropdown__link" href="/contrast/1.13">1.13</a></li><li><a class="dropdown__link" href="/contrast/1.12">1.12</a></li><li><a class="dropdown__link" href="/contrast/1.11">1.11</a></li><li><a class="dropdown__link" href="/contrast/1.10/examples/mysql">1.10</a></li><li><a class="dropdown__link" href="/contrast/1.9/examples/mysql">1.9</a></li><li><a class="dropdown__link" href="/contrast/1.8/examples/mysql">1.8</a></li><li><a class="dropdown__link" href="/contrast/1.7/examples/mysql">1.7</a></li><li><a class="dropdown__link" href="/contrast/1.6/examples/mysql">1.6</a></li><li><a class="dropdown__link" href="/contrast/1.5/examples/mysql">1.5</a></li><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/contrast/1.4/examples/mysql">1.4</a></li><li><a class="dropdown__link" href="/contrast/1.3/examples/mysql">1.3</a></li></ul></div><a href="https://github.com/edgelesssys/contrast" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-1.4"></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/contrast/1.4"><span title="What is Contrast?" class="linkLabel_WmDU">What is Contrast?</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/contrast/1.4/basics/confidential-containers"><span title="Basics" class="categoryLinkLabel_W154">Basics</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contrast/1.4/basics/confidential-containers"><span title="Confidential Containers" class="linkLabel_WmDU">Confidential Containers</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contrast/1.4/basics/security-benefits"><span title="Security benefits" class="linkLabel_WmDU">Security benefits</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contrast/1.4/basics/features"><span title="Features" class="linkLabel_WmDU">Features</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/contrast/1.4/getting-started/install"><span title="Getting started" class="categoryLinkLabel_W154">Getting started</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contrast/1.4/getting-started/install"><span title="Install" class="linkLabel_WmDU">Install</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contrast/1.4/getting-started/cluster-setup"><span title="Cluster setup" class="linkLabel_WmDU">Cluster setup</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contrast/1.4/getting-started/bare-metal"><span title="Bare metal setup" class="linkLabel_WmDU">Bare metal setup</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/contrast/1.4/examples/emojivoto"><span title="Examples" class="categoryLinkLabel_W154">Examples</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/contrast/1.4/examples/emojivoto"><span title="Confidential emoji voting" class="linkLabel_WmDU">Confidential emoji voting</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/contrast/1.4/examples/mysql"><span title="Encrypted volume mount" class="linkLabel_WmDU">Encrypted volume mount</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/contrast/1.4/deployment"><span title="Workload deployment" class="linkLabel_WmDU">Workload deployment</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/contrast/1.4/troubleshooting"><span title="Troubleshooting" class="linkLabel_WmDU">Troubleshooting</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/contrast/1.4/components/overview"><span title="Components" class="categoryLinkLabel_W154">Components</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/contrast/1.4/architecture/attestation"><span title="Architecture" class="categoryLinkLabel_W154">Architecture</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/contrast/1.4/features-limitations"><span title="Planned features and limitations" class="linkLabel_WmDU">Planned features and limitations</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/contrast/1.4/about/telemetry"><span title="About" class="categoryLinkLabel_W154">About</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Contrast<!-- --> <b>1.4</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/contrast/">latest version</a></b> (<!-- -->1.15<!-- -->).</div></div><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/contrast/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Examples</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Encrypted volume mount</span></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 1.4</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Encrypted volume mount</h1></header>
<p><strong>This tutorial guides you through deploying a simple application with an
encrypted MySQL database using the Contrast <a class="" href="/contrast/1.4/architecture/secrets#workload-secrets">workload
secret</a>.</strong></p>
<p><a href="https://mysql.com" target="_blank" rel="noopener noreferrer" class="">MySQL</a> is an open-source database used to organize data into
tables and quickly retrieve information about its content. All of the data in a
MySQL database is stored in the <code>/var/lib/mysql</code> directory. In this example, we
use the workload secret to setup an encrypted LUKS mount for the
<code>/var/lib/mysql</code> directory to easily deploy an application with encrypted
persistent storage using Contrast.</p>
<p>The resources provided in this demo are designed for educational purposes and
shouldn&#x27;t be used in a production environment without proper evaluation. When
working with persistent storage, regular backups are recommended in order to
prevent data loss. For confidential applications, please also refer to the
<a class="" href="/contrast/1.4/architecture/security-considerations">security considerations</a>. Also be
aware of the differences in security implications of the workload secrets for
the data owner and the workload owner. For more details, see the <a class="" href="/contrast/1.4/architecture/secrets#workload-secrets">Workload
Secrets</a> documentation.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate="no">​</a></h2>
<ul>
<li class="">Installed Contrast CLI</li>
<li class="">A running Kubernetes cluster with support for confidential containers, either on <a class="" href="/contrast/1.4/getting-started/cluster-setup">AKS</a> or on <a class="" href="/contrast/1.4/getting-started/bare-metal">bare metal</a></li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="steps-to-deploy-mysql-with-contrast">Steps to deploy MySQL with Contrast<a href="#steps-to-deploy-mysql-with-contrast" class="hash-link" aria-label="Direct link to Steps to deploy MySQL with Contrast" title="Direct link to Steps to deploy MySQL with Contrast" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="download-the-deployment-files">Download the deployment files<a href="#download-the-deployment-files" class="hash-link" aria-label="Direct link to Download the deployment files" title="Direct link to Download the deployment files" translate="no">​</a></h3>
<p>The MySQL deployment files are part of the Contrast release. You can download them by running:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-fLO</span><span class="token plain"> https://github.com/edgelesssys/contrast/releases/download/v1.4.1/mysql-demo.yml --create-dirs --output-dir deployment</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="deploy-the-contrast-runtime">Deploy the Contrast runtime<a href="#deploy-the-contrast-runtime" class="hash-link" aria-label="Direct link to Deploy the Contrast runtime" title="Direct link to Deploy the Contrast runtime" translate="no">​</a></h3>
<p>Contrast depends on a <a class="" href="/contrast/1.4/components/runtime">custom Kubernetes <code>RuntimeClass</code></a>,
which needs to be installed to the cluster initially.
This consists of a <code>RuntimeClass</code> resource and a <code>DaemonSet</code> that performs installation on worker nodes.
This step is only required once for each version of the runtime.
It can be shared between Contrast deployments.</p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">AKS</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Bare metal (SEV-SNP)</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Bare metal (TDX)</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> https://github.com/edgelesssys/contrast/releases/download/v1.4.1/runtime-aks-clh-snp.yml</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> https://github.com/edgelesssys/contrast/releases/download/v1.4.1/runtime-k3s-qemu-snp.yml</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> https://github.com/edgelesssys/contrast/releases/download/v1.4.1/runtime-k3s-qemu-tdx.yml</span><br></span></code></pre></div></div></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="deploy-the-contrast-coordinator">Deploy the Contrast Coordinator<a href="#deploy-the-contrast-coordinator" class="hash-link" aria-label="Direct link to Deploy the Contrast Coordinator" title="Direct link to Deploy the Contrast Coordinator" translate="no">​</a></h3>
<p>Deploy the Contrast Coordinator, comprising a single replica deployment and a
<code>LoadBalancer</code> service, into your cluster:</p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">AKS</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Bare metal (SEV-SNP)</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Bare metal (TDX)</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> https://github.com/edgelesssys/contrast/releases/download/v1.4.1/coordinator-aks-clh-snp.yml</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> https://github.com/edgelesssys/contrast/releases/download/v1.4.1/coordinator-k3s-qemu-snp.yml</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> https://github.com/edgelesssys/contrast/releases/download/v1.4.1/coordinator-k3s-qemu-tdx.yml</span><br></span></code></pre></div></div></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="generate-policy-annotations-and-manifest">Generate policy annotations and manifest<a href="#generate-policy-annotations-and-manifest" class="hash-link" aria-label="Direct link to Generate policy annotations and manifest" title="Direct link to Generate policy annotations and manifest" translate="no">​</a></h3>
<p>Run the <code>generate</code> command to generate the execution policies and add them as
annotations to your deployment files. A <code>manifest.json</code> file with the reference values
of your deployment will be created:</p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">AKS</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Bare metal (SEV-SNP)</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Bare metal (TDX)</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contrast generate --reference-values aks-clh-snp deployment/</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contrast generate --reference-values k3s-qemu-snp deployment/</span><br></span></code></pre></div></div><div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Missing TCB values</div><div class="admonitionContent_BuS1"><p>On bare-metal SEV-SNP, <code>contrast generate</code> is unable to fill in the <code>MinimumTCB</code> values as they can vary between platforms.
They will have to be filled in manually.
If you don&#x27;t know the correct values use <code>{&quot;BootloaderVersion&quot;:255,&quot;TEEVersion&quot;:255,&quot;SNPVersion&quot;:255,&quot;MicrocodeVersion&quot;:255}</code> and observe the real values in the error messages in the following steps. This should only be done in a secure environment. Note that the values will differ between CPU models.</p></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contrast generate --reference-values k3s-qemu-tdx deployment/</span><br></span></code></pre></div></div><div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Missing TCB values</div><div class="admonitionContent_BuS1"><p>On bare-metal TDX, <code>contrast generate</code> is unable to fill in the <code>MinimumTeeTcbSvn</code> and <code>MrSeam</code> TCB values as they can vary between platforms.
They will have to be filled in manually.
If you don&#x27;t know the correct values use <code>ffffffffffffffffffffffffffffffff</code> and <code>000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</code> respectively and observe the real values in the error messages in the following steps. This should only be done in a secure environment.</p></div></div></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Runtime class and Initializer</div><div class="admonitionContent_BuS1"><p>The deployment YAML shipped for this demo is already configured to be used with Contrast.
A <a class="" href="/contrast/1.4/components/runtime">runtime class</a> <code>contrast-cc</code>
was added to the pods to signal they should be run as Confidential Containers. During the generation process,
the Contrast <a class="" href="/contrast/1.4/components/overview#the-initializer">Initializer</a> will be added as an init container to these
workloads. It will attest the pod to the Coordinator and fetch the workload certificates and the workload secret.</p><p>Further, the deployment YAML is also configured with the Contrast <a class="" href="/contrast/1.4/components/service-mesh">service mesh</a>.
The configured service mesh proxy provides transparent protection for the communication between
the MySQL server and client.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="set-the-manifest">Set the manifest<a href="#set-the-manifest" class="hash-link" aria-label="Direct link to Set the manifest" title="Direct link to Set the manifest" translate="no">​</a></h3>
<p>Configure the coordinator with a manifest. It might take up to a few minutes
for the load balancer to be created and the Coordinator being available.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">coordinator</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable" style="color:#36acaa">kubectl get svc coordinator </span><span class="token variable parameter variable" style="color:#36acaa">-o</span><span class="token variable operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">jsonpath</span><span class="token variable operator" style="color:#393A34">=</span><span class="token variable string" style="color:#e3116c">&#x27;{.status.loadBalancer.ingress[0].ip}&#x27;</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;The user API of your Contrast Coordinator is available at </span><span class="token string variable" style="color:#36acaa">$coordinator</span><span class="token string" style="color:#e3116c">:1313&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contrast </span><span class="token builtin class-name">set</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${coordinator}</span><span class="token string" style="color:#e3116c">:1313&quot;</span><span class="token plain"> deployment/</span><br></span></code></pre></div></div>
<p>The CLI will use the reference values from the manifest to attest the Coordinator deployment
during the TLS handshake. If the connection succeeds, it&#x27;s ensured that the Coordinator
deployment hasn&#x27;t been tampered with.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>On bare metal, the <a class="" href="/contrast/1.4/components/policies#platform-differences">coordinator policy hash</a> must be overwritten using <code>--coordinator-policy-hash</code>.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="deploy-mysql">Deploy MySQL<a href="#deploy-mysql" class="hash-link" aria-label="Direct link to Deploy MySQL" title="Direct link to Deploy MySQL" translate="no">​</a></h3>
<p>Now that the coordinator has a manifest set, which defines the MySQL deployment as an allowed workload,
we can deploy the application:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl apply </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> deployment/</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Persistent workload secrets</div><div class="admonitionContent_BuS1"><p>During the initialization process of the workload pod, the Contrast Initializer
sends an attestation report to the Coordinator and receives a workload secret
derived from the Coordinator&#x27;s secret seed and the workload secret ID specified in the
manifest, and writes it to a secure in-memory <code>volumeMount</code>.</p></div></div>
<p>The MySQL deployment is declared as a StatefulSet with a mounted block device.
An init container running <code>cryptsetup</code> uses the workload secret at
<code>/contrast/secrets/workload-secret-seed</code> to generate a key and setup the block
device as a LUKS partition. Before starting the MySQL container, the init
container uses the generated key to open the LUKS device, which is then mounted
by the MySQL container. For the MySQL container, this process is completely
transparent and works like mounting any other volume. The <code>cryptsetup</code> container
will remain running to provide the necessary decryption context for the workload
container.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="verifying-the-deployment-as-a-user">Verifying the deployment as a user<a href="#verifying-the-deployment-as-a-user" class="hash-link" aria-label="Direct link to Verifying the deployment as a user" title="Direct link to Verifying the deployment as a user" translate="no">​</a></h2>
<p>In different scenarios, users of an app may want to verify its security and identity before sharing data, for example, before connecting to the database.
With Contrast, a user only needs a single remote-attestation step to verify the deployment - regardless of the size or scale of the deployment.
Contrast is designed such that, by verifying the Coordinator, the user transitively verifies those systems the Coordinator has already verified or will verify in the future.
Successful verification of the Coordinator means that the user can be sure that the given manifest will be enforced.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="verifying-the-coordinator">Verifying the Coordinator<a href="#verifying-the-coordinator" class="hash-link" aria-label="Direct link to Verifying the Coordinator" title="Direct link to Verifying the Coordinator" translate="no">​</a></h3>
<p>A user can verify the Contrast deployment using the verify
command:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contrast verify </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${coordinator}</span><span class="token string" style="color:#e3116c">:1313&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> manifest.json</span><br></span></code></pre></div></div>
<p>The CLI will verify the Coordinator via remote attestation using the reference values from a given manifest. This manifest needs
to be communicated out of band to everyone wanting to verify the deployment, as the <code>verify</code> command checks
if the currently active manifest at the Coordinator matches the manifest given to the CLI. If the command succeeds,
the Coordinator deployment was successfully verified to be running in the expected Confidential
Computing environment with the expected code version. The Coordinator will then return its
configuration over the established TLS channel. The CLI will store this information, namely the root
certificate of the mesh (<code>mesh-ca.pem</code>) and the history of manifests, into the <code>verify/</code> directory.
In addition, the policies referenced in the manifest history are also written into the same directory.</p>
<div class="theme-admonition theme-admonition-warning admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>warning</div><div class="admonitionContent_BuS1"><p>On bare metal, the <a class="" href="/contrast/1.4/components/policies#platform-differences">coordinator policy hash</a> must be overwritten using <code>--coordinator-policy-hash</code>.</p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="auditing-the-manifest-history-and-artifacts">Auditing the manifest history and artifacts<a href="#auditing-the-manifest-history-and-artifacts" class="hash-link" aria-label="Direct link to Auditing the manifest history and artifacts" title="Direct link to Auditing the manifest history and artifacts" translate="no">​</a></h3>
<p>In the next step, the Coordinator configuration that was written by the <code>verify</code> command needs to be audited.
A user of the application should inspect the manifest and the referenced policies. They could delegate
this task to an entity they trust.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="connecting-to-the-application">Connecting to the application<a href="#connecting-to-the-application" class="hash-link" aria-label="Direct link to Connecting to the application" title="Direct link to Connecting to the application" translate="no">​</a></h3>
<p>Other confidential containers can securely connect to the MySQL server via the
<a class="" href="/contrast/1.4/components/service-mesh">Service Mesh</a>. The configured <code>mysql-client</code>
deployment connects to the MySQL server and inserts test data into a table. To
view the logs of the <code>mysql-client</code> deployment, use the following commands:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl logs </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> app.kubernetes.io/name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">mysql-client </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> mysql-client</span><br></span></code></pre></div></div>
<p>The Service Mesh ensures an mTLS connection between the MySQL client and server
using the mesh certificates. As a result, no other workload can connect to the
MySQL server unless explicitly allowed in the manifest.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="updating-the-deployment">Updating the deployment<a href="#updating-the-deployment" class="hash-link" aria-label="Direct link to Updating the deployment" title="Direct link to Updating the deployment" translate="no">​</a></h2>
<p>Because the workload secret is derived from the <code>WorkloadSecredID</code> specified in
the manifest and not to an individual pod, once the pod restarts, the
<code>cryptsetup</code> init container can deterministically generate the same key again
and open the already partitioned LUKS device.
For more information on using the workload secret, see <a class="" href="/contrast/1.4/architecture/secrets#workload-secrets">Workload
Secrets</a>.</p>
<p>For example, after making changes to the deployment files, the runtime policies
need to be regenerated with <code>contrast generate</code> and the new manifest needs to be
set using <code>contrast set</code>.</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">contrast generate deployment/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contrast </span><span class="token builtin class-name">set</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${coordinator}</span><span class="token string" style="color:#e3116c">:1313&quot;</span><span class="token plain"> deployment/</span><br></span></code></pre></div></div>
<p>The new deployment can then be applied by running:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl rollout restart statefulset/mysql-backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl rollout restart deployment/mysql-client</span><br></span></code></pre></div></div>
<p>The new MySQL backend pod will then start up the <code>cryptsetup</code> init container which
receives the same workload secret as before and can therefore generate the
correct key to open the LUKS device. All previously stored data in the MySQL
database is available in the newly created pod in an encrypted volume mount.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/edgelesssys/contrast/edit/main/docs/versioned_docs/version-1.4/examples/mysql.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/contrast/1.4/examples/emojivoto"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Confidential emoji voting</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/contrast/1.4/deployment"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Workload deployment</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#steps-to-deploy-mysql-with-contrast" class="table-of-contents__link toc-highlight">Steps to deploy MySQL with Contrast</a><ul><li><a href="#download-the-deployment-files" class="table-of-contents__link toc-highlight">Download the deployment files</a></li><li><a href="#deploy-the-contrast-runtime" class="table-of-contents__link toc-highlight">Deploy the Contrast runtime</a></li><li><a href="#deploy-the-contrast-coordinator" class="table-of-contents__link toc-highlight">Deploy the Contrast Coordinator</a></li><li><a href="#generate-policy-annotations-and-manifest" class="table-of-contents__link toc-highlight">Generate policy annotations and manifest</a></li><li><a href="#set-the-manifest" class="table-of-contents__link toc-highlight">Set the manifest</a></li><li><a href="#deploy-mysql" class="table-of-contents__link toc-highlight">Deploy MySQL</a></li></ul></li><li><a href="#verifying-the-deployment-as-a-user" class="table-of-contents__link toc-highlight">Verifying the deployment as a user</a><ul><li><a href="#verifying-the-coordinator" class="table-of-contents__link toc-highlight">Verifying the Coordinator</a></li><li><a href="#auditing-the-manifest-history-and-artifacts" class="table-of-contents__link toc-highlight">Auditing the manifest history and artifacts</a></li><li><a href="#connecting-to-the-application" class="table-of-contents__link toc-highlight">Connecting to the application</a></li></ul></li><li><a href="#updating-the-deployment" class="table-of-contents__link toc-highlight">Updating the deployment</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.edgeless.systems/#footer-id" target="_blank" rel="noopener noreferrer" class="footer__link-item">Newsletter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Social</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.edgeless.systems/blog/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://twitter.com/EdgelessSystems" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/edgeless-systems/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCOOInN0sCv6icUesisYIDeA" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Company</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.edgeless.systems/imprint/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Imprint<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://www.edgeless.systems/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy Policy<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="javascript: Cookiebot.renew()" class="footer__link-item">Cookie Settings</a></li><li class="footer__item"><a href="https://www.edgeless.systems/contact-us/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact Us<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Edgeless Systems</div></div></div></footer></div>
</body>
</html>