"use strict";(self.webpackChunkcontrast_docs=self.webpackChunkcontrast_docs||[]).push([[5424],{1360:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>i,default:()=>h,frontMatter:()=>l,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"howto/workload-deployment/runtime-deployment","title":"Deploy the Contrast runtime","description":"This step configures the host environment on your Kubernetes worker nodes.","source":"@site/versioned_docs/version-1.12/howto/workload-deployment/runtime-deployment.md","sourceDirName":"howto/workload-deployment","slug":"/howto/workload-deployment/runtime-deployment","permalink":"/contrast/1.12/howto/workload-deployment/runtime-deployment","draft":false,"unlisted":false,"editUrl":"https://github.com/edgelesssys/contrast/edit/main/docs/versioned_docs/version-1.12/howto/workload-deployment/runtime-deployment.md","tags":[],"version":"1.12","frontMatter":{},"sidebar":"docs","previous":{"title":"Install CLI","permalink":"/contrast/1.12/howto/install-cli"},"next":{"title":"Add Coordinator to resources","permalink":"/contrast/1.12/howto/workload-deployment/add-coordinator"}}');var s=n(74848),r=n(28453);const l={},i="Deploy the Contrast runtime",a={},d=[{value:"Applicability",id:"applicability",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"How-to",id:"how-to",level:2}];function c(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components},{TabItem:n,Tabs:o}=t;return n||u("TabItem",!0),o||u("Tabs",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"deploy-the-contrast-runtime",children:"Deploy the Contrast runtime"})}),"\n",(0,s.jsx)(t.p,{children:"This step configures the host environment on your Kubernetes worker nodes."}),"\n",(0,s.jsx)(t.h2,{id:"applicability",children:"Applicability"}),"\n",(0,s.jsx)(t.p,{children:"Required for all Contrast deployments."}),"\n",(0,s.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"/contrast/1.12/howto/cluster-setup/aks",children:"Set up cluster"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"/contrast/1.12/howto/install-cli",children:"Install CLI"})}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"how-to",children:"How-to"}),"\n",(0,s.jsxs)(t.p,{children:["Contrast depends on a ",(0,s.jsxs)(t.a,{href:"/contrast/1.12/architecture/components/runtime",children:["custom Kubernetes ",(0,s.jsx)(t.code,{children:"RuntimeClass"})," (",(0,s.jsx)(t.code,{children:"contrast-cc"}),")"]}),", which needs to be installed in the cluster prior to the Coordinator or any confidential workloads.\nThis consists of a ",(0,s.jsx)(t.code,{children:"RuntimeClass"})," resource and a ",(0,s.jsx)(t.code,{children:"DaemonSet"})," that performs installation on worker nodes.\nThis step is only required once for each version of the runtime.\nIt can be shared between Contrast deployments.\nAlso, different Contrast runtime versions can be installed in the same cluster."]}),"\n",(0,s.jsxs)(o,{queryString:"platform",children:[(0,s.jsx)(n,{value:"aks-clh-snp",label:"AKS",default:!0,children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"kubectl apply -f https://github.com/edgelesssys/contrast/releases/download/v1.12.2/runtime-aks-clh-snp.yml\n"})})}),(0,s.jsx)(n,{value:"k3s-qemu-snp",label:"Bare metal (SEV-SNP)",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"kubectl apply -f https://github.com/edgelesssys/contrast/releases/download/v1.12.2/runtime-k3s-qemu-snp.yml\n"})})}),(0,s.jsx)(n,{value:"k3s-qemu-snp-gpu",label:"Bare metal (SEV-SNP, with GPU support)",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"kubectl apply -f https://github.com/edgelesssys/contrast/releases/download/v1.12.2/runtime-k3s-qemu-snp-gpu.yml\n"})})}),(0,s.jsx)(n,{value:"k3s-qemu-tdx",label:"Bare metal (TDX)",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-sh",children:"kubectl apply -f https://github.com/edgelesssys/contrast/releases/download/v1.12.2/runtime-k3s-qemu-tdx.yml\n"})})})]}),"\n",(0,s.jsxs)(t.admonition,{title:"Modifications to containerd configuration",type:"warning",children:[(0,s.jsx)(t.p,{children:"The Contrast node installer will modify the containerd configuration on the worker nodes to add the runtime class.\nA backup will be created for the original configuration."}),(0,s.jsx)(t.p,{children:"Some Kubernetes platforms, for example K3s, use a template for the containerd configuration.\nNotice that Contrast can't modify these templates, but will write the templated version instead.\nAny modifications made to the template afterward won't take effect."})]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}function u(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},28453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>i});var o=n(96540);const s={},r=o.createContext(s);function l(e){const t=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),o.createElement(r.Provider,{value:t},e.children)}}}]);